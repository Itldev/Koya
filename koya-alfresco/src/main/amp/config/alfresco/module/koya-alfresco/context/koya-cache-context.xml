<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:cache="http://www.springframework.org/schema/cache" 
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd">
 
    <cache:annotation-driven cache-manager="cacheManager"  />
    
    <bean id="cacheManager" 
          class="org.springframework.cache.ehcache.EhCacheCacheManager"
          p:cache-manager-ref="ehcache"/>

    <!-- EhCache library setup -->
    <bean id="ehcache" 
          class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"
          p:config-location="classpath:alfresco/module/koya-alfresco/ehcache.xml"
          p:shared='true'/>
    
    
     <bean name="ehCacheManagerMBean" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" >
    <property name="shared" value="true" />
  </bean>
    <bean id="mbeanExporter" class="org.springframework.jmx.export.MBeanExporter">
    <property name="beans">
      <map>
        <entry key="MyApp:name=ehCacheManagerMBean" value-ref="ehCacheManagerMBean" />
      </map>
    </property>
  </bean>
 
  <!--    <bean id="ehCacheMBeanRegistration" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
      <property name="staticMethod" value="net.sf.ehcache.management.ManagementService.registerMBeans"/>
      <property name="arguments">
          <list>
              <ref bean="cacheManager"/>
              <ref bean="mbeanServer"/>
              <value>true</value>
              <value>true</value>
              <value>true</value>
              <value>true</value>
          </list>
      </property>
  </bean>   
  <bean id="mbeanServer" class="org.springframework.jmx.support.MBeanServerFactoryBean">
      <property name="locateExistingServerIfPossible" value="true"/>
  </bean>-->
</beans>

<?xml version='1.0' encoding='UTF-8'?>
<!--

    Koya is an alfresco module that provides a corporate orientated dataroom.

    Copyright (C) Itl Developpement 2014

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see `<http://www.gnu.org/licenses/>`.

-->

<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>
<beans>
    
    
    <!--
    ==================================================================
    ========================== Companies ==============================
    ==================================================================
    -->
    <!--create company-->
    <bean id="webscript.fr.itldev.koya.company.addcompany.post" 
          class="fr.itldev.koya.webscript.company.AddCompany"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    <!--list companies-->
    <bean id="webscript.fr.itldev.koya.company.list.get"
          class="fr.itldev.koya.webscript.company.ListCompany"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    
    <!-- list members-->
    <bean id="webscript.fr.itldev.koya.company.listMembers.get" 
          class="fr.itldev.koya.webscript.company.ListMembers"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" />       
        <property name="koyaNodeService" ref="koyaNodeService" />        
    </bean>
    
    
    <!-- get current preferences-->
    <bean id="webscript.fr.itldev.koya.company.preferences.get" 
          class="fr.itldev.koya.webscript.company.GetPreferences"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    
    <!-- commit preferences-->
    <bean id="webscript.fr.itldev.koya.company.preferences.post" 
          class="fr.itldev.koya.webscript.company.CommitPreferences"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    
    
    <!-- get current properties-->
    <bean id="webscript.fr.itldev.koya.company.properties.get" 
          class="fr.itldev.koya.webscript.company.GetProperties"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    
    <!-- commit properties-->
    <bean id="webscript.fr.itldev.koya.company.properties.post" 
          class="fr.itldev.koya.webscript.company.CommitProperties"
          parent="webscript">                
        <property name="companyService" ref="companyService" />        
    </bean>
    
    
    <!-- get available roles-->
    <bean id="webscript.fr.itldev.koya.company.roles.get" 
          class="fr.itldev.koya.webscript.company.GetRoles"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" />       
        <property name="koyaNodeService" ref="koyaNodeService" />        
    </bean>
    
    
    <!-- Check if user is manager on specified company-->
    <bean id="webscript.fr.itldev.koya.company.ismanager.get" 
          class="fr.itldev.koya.webscript.company.IsManager"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" />    
    </bean>
    
    <!--
    ==================================================================
    ========================== Sale Offers ==================
    ==================================================================
    -->
    <!--liste des Offres commerciales -->
    <bean id="webscript.fr.itldev.koya.salesoffer.list.get" 
          class="fr.itldev.koya.webscript.salesoffer.ListOffer"
          parent="webscript">                
        <property name="salesOfferService" ref="salesOfferService" />
    </bean>
    <!--
    ==================================================================
    ========================== Spaces ==============================
    ==================================================================
    -->
    
    <!--space creation-->
    <bean id="webscript.fr.itldev.koya.space.add.post"
          class="fr.itldev.koya.webscript.space.AddSpace"
          parent="webscript">                
        <property name="spaceService" ref="spaceService" /> 
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    <!-- apply space template -->
    <bean id="webscript.fr.itldev.koya.space.apply-template.get" 
          class="fr.itldev.koya.webscript.space.ApplyTemplates"
          parent="webscript"> 
        <property name="modelService" ref="modelService"/>               
    </bean>
    
    <!-- list spaces -->
    <bean id="webscript.fr.itldev.koya.space.list.post" 
          class="fr.itldev.koya.webscript.space.ListSpace"
          parent="webscript">                
        <property name="spaceService" ref="spaceService" />
        
    </bean>
    
        
    
    <!--move a space-->
    <bean id="webscript.fr.itldev.koya.space.move.post" 
          class="fr.itldev.koya.webscript.space.MoveSpace"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />
    </bean>
    
    
    <!--
    ==================================================================
    ========================== Dossiers ==============================
    ==================================================================
    -->
    
    <!--create Dossier-->
    <bean id="webscript.fr.itldev.koya.dossier.create.get" 
          class="fr.itldev.koya.webscript.dossier.CreateDossier"
          parent="webscript">                
        <property name="dossierService" ref="dossierService" />
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    <!--list Dossiers-->
    <bean id="webscript.fr.itldev.koya.dossier.list.get" 
          class="fr.itldev.koya.webscript.dossier.ListDossier"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />   
        <property name="nodeService" ref="NodeService" />   
        
    </bean>
    
        
    <!--list dossier responsibles-->
    <bean id="webscript.fr.itldev.koya.dossier.listresponsible.get" 
          class="fr.itldev.koya.webscript.dossier.ListResponsible"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="SubSpaceCollaboratorsAclService" ref="SubSpaceCollaboratorsAclService"/>
    </bean>
    
    
    <!-- add dossier responsibles-->
    <bean id="webscript.fr.itldev.koya.dossier.addresponsible.get" 
          class="fr.itldev.koya.webscript.dossier.AddResponsible"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="SubSpaceCollaboratorsAclService" ref="SubSpaceCollaboratorsAclService"/>
        <property name="userService" ref="userService"/>
    </bean>
    
    
    <!--list dossier members-->
    <bean id="webscript.fr.itldev.koya.dossier.listmember.get" 
          class="fr.itldev.koya.webscript.dossier.ListMember"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="SubSpaceCollaboratorsAclService" ref="SubSpaceCollaboratorsAclService"/>
    </bean>
    
    
    <!-- add dossier responsibles-->
    <bean id="webscript.fr.itldev.koya.dossier.addmember.get" 
          class="fr.itldev.koya.webscript.dossier.AddMember"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="SubSpaceCollaboratorsAclService" ref="SubSpaceCollaboratorsAclService"/>
        <property name="userService" ref="userService"/>
    </bean>
    
    <!--del dossier responsibles or members -->
    <bean id="webscript.fr.itldev.koya.dossier.delresponsible.get" 
          class="fr.itldev.koya.webscript.dossier.DelResponsible"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="SubSpaceCollaboratorsAclService" ref="SubSpaceCollaboratorsAclService"/>
        <property name="userService" ref="userService"/>

    </bean>
       
    <!--
    ==================================================================
    ========================== Contents ============================
    ==================================================================
    -->
 
    <!--content creation-->
    <bean id="webscript.fr.itldev.koya.content.createdir.get" 
          class="fr.itldev.koya.webscript.content.CreateDir"
          parent="webscript">                
        <property name="koyaContentService" ref="koyaContentService" />
        <property name="koyaNodeService" ref="koyaNodeService" />        
    </bean>
    <!--content listing-->
    <bean id="webscript.fr.itldev.koya.content.list.get" 
          class="fr.itldev.koya.webscript.content.ListContent"
          parent="webscript">                
        <property name="koyaContentService" ref="koyaContentService" />  
        <property name="koyaNodeService" ref="koyaNodeService" />     
        <property name="nodeService" ref="NodeService" />      
    </bean>
    
    <!--content move-->
    <bean id="webscript.fr.itldev.koya.content.move.get" 
          class="fr.itldev.koya.webscript.content.MoveContent"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    <!--content copy-->
    <bean id="webscript.fr.itldev.koya.content.copy.get" 
          class="fr.itldev.koya.webscript.content.CopyContent"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
   
    
    <!-- zip content-->
    <bean id="webscript.fr.itldev.koya.content.zip.post" 
          class="fr.itldev.koya.webscript.content.ZipContent"
          parent="webscript">                
        <property name="koyaContentService" ref="koyaContentService" />
    </bean>
    
    
    <!-- import Zip -->
    <bean id="webscript.fr.itldev.koya.content.importzip.get" 
          class="fr.itldev.koya.webscript.content.ImportZip"
          parent="webscript">                
        <property name="koyaContentService" ref="koyaContentService" />
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.content.upload.post" 
          class="fr.itldev.koya.webscript.content.Upload"
          parent="webscript">                
        <property name="koyaContentService" ref="koyaContentService" />
        <property name="koyaNodeService" ref="koyaNodeService" />         
    </bean>
    
    <!--
    ==================================================================
    ========================== Favourites ============================
    ==================================================================
    -->
    
    <!-- Get Users Favourites -->
    <bean id="webscript.fr.itldev.koya.favourites.list.get" 
          class="fr.itldev.koya.webscript.favourites.List"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />      
    </bean>
    
    <!--Change or get Favourite Status-->
    <bean id="webscript.fr.itldev.koya.favourites.set.post" 
          class="fr.itldev.koya.webscript.favourites.Set"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    <!--
    ==================================================================
    ========================== Global ============================
    ==================================================================
    -->
    
    <!--Get used disk size-->
    <bean id="webscript.fr.itldev.koya.global.disksize.get" 
          class="fr.itldev.koya.webscript.global.DiskSize"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />  
    </bean>
    
    <bean id="webscript.fr.itldev.koya.global.secureditem.get" 
          class="fr.itldev.koya.webscript.global.GetSecuredItem"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    <!-- rename secured item -->
    <bean id="webscript.fr.itldev.koya.global.rename.post" 
          class="fr.itldev.koya.webscript.global.Rename"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />          
    </bean>
    
    <!-- delete secured item -->
    <bean id="webscript.fr.itldev.koya.global.delete.get" 
          class="fr.itldev.koya.webscript.global.Delete"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />         
    </bean>
    
    <!--get Parent-->
    <bean id="webscript.fr.itldev.koya.global.parents.get" 
          class="fr.itldev.koya.webscript.global.GetParent"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />     
    </bean>
    
    <!--send email-->
    <bean id="webscript.fr.itldev.koya.global.mail.post" 
          class="fr.itldev.koya.webscript.global.SendMail"
          parent="webscript">                
        <property name="koyaMailService" ref="koyaMailService" />
    </bean>
    
    
    
    <!-- Get Permissions on node -->
    <bean id="webscript.fr.itldev.koya.global.secu.permissions.get" 
          class="fr.itldev.koya.webscript.global.secu.GetPermissions"
          parent="webscript">                
        <property name="subSpaceAclService" ref="subSpaceAclService" />  
        <property name="koyaNodeService" ref="koyaNodeService" />       
    </bean>
    
    
    <!--Get used disk size-->
    <bean id="webscript.fr.itldev.koya.global.xpath2noderef.get" 
          class="fr.itldev.koya.webscript.global.XPath2NodeRef"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />  
    </bean>
    
    <!--count Children of given type-->
    <bean id="webscript.fr.itldev.koya.global.countchildren.post" 
          class="fr.itldev.koya.webscript.global.CountChildren"
          parent="webscript">            
        <property name="koyaNodeService" ref="koyaNodeService" />   
    </bean>
    
    
    
    <!--
    ==================================================================
    ========================== Users ==============================
    ==================================================================
    -->
    
    <bean id="webscript.fr.itldev.koya.user.modifydetails.post" 
          class="fr.itldev.koya.webscript.user.ModifyDetails"
          parent="webscript">                
        <property name="userService" ref="userService" /> 
    </bean>
    
    <bean id="webscript.fr.itldev.koya.user.find.get" 
          class="fr.itldev.koya.webscript.user.Find"
          parent="webscript">                
        <property name="userService" ref="userService" /> 
    </bean>
    
    <bean id="webscript.fr.itldev.koya.user.changepassword.get" 
          class="fr.itldev.koya.webscript.user.ChangePassword"
          parent="webscript">                
        <property name="userService" ref="userService" /> 
    </bean>
    
    <bean id="webscript.fr.itldev.koya.user.getbyauthkey.post" 
          class="fr.itldev.koya.webscript.user.GetByAuthKey"
          parent="webscript">                
        <property name="userService" ref="userService" /> 
    </bean>
    
    
    
    <!-- get user role for a company -->
    <bean id="webscript.fr.itldev.koya.user.role.get" 
          class="fr.itldev.koya.webscript.user.GetRole"
          parent="webscript">                
        <property name="koyaNodeService" ref="koyaNodeService" />      
        <property name="userService" ref="userService" />      
        <property name="companyAclService" ref="companyAclService" />        
    </bean>

    <!-- set user role for a company -->
    <bean id="webscript.fr.itldev.koya.user.setrole.get" 
          class="fr.itldev.koya.webscript.user.SetRole"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" />        
        <property name="koyaNodeService" ref="koyaNodeService" />        
        <property name="userService" ref="userService" />        
    </bean>
    
    
    
   
    
    <bean id="webscript.fr.itldev.koya.user.revoke.get" 
          class="fr.itldev.koya.webscript.user.Revoke"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" /> 
        <property name="koyaNodeService" ref="koyaNodeService" /> 
        <property name="userService" ref="userService" /> 

    </bean>
    
    <bean id="webscript.fr.itldev.koya.user.listconnect.get"
          class="fr.itldev.koya.webscript.user.ListConnect"
          parent="webscript">                
        <property name="userService" ref="userService" /> 
    </bean>

    
    
    
    <!--
    ==================================================================
    ========================== Invitation ==============================
    ==================================================================
    -->
    
    
    <bean id="webscript.fr.itldev.koya.invitation.invitation.get"
          class="fr.itldev.koya.webscript.invitation.GetInvitation"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" />
        <property name="koyaNodeService" ref="koyaNodeService" /> 
        <property name="userService" ref="userService" /> 
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.invitation.sendmail.post"
          class="fr.itldev.koya.webscript.invitation.SendInviteMail"
          parent="webscript">                    
        <property name="workflowService" ref="WorkflowService"/>
        <property name="serviceRegistry" ref="ServiceRegistry"/>
        <property name="repositoryHelper" ref="repositoryHelper"/>
        <property name="messageService" ref="messageService"/>        
        <property name="koyaMailService" ref="koyaMailService"/>
        <property name="koyaNodeService" ref="koyaNodeService"/> 
        <property name="companyAclService" ref="companyAclService"/> 
        <property name="authenticationService" ref="AuthenticationService"/> 
        <property name="userService" ref="userService"/>         
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.invitation.invite.post" 
          class="fr.itldev.koya.webscript.invitation.Invite"
          parent="webscript">                
        <property name="companyAclService" ref="companyAclService" /> 
        <property name="koyaNodeService" ref="koyaNodeService" /> 
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.invitation.validate.post" 
          class="fr.itldev.koya.webscript.invitation.ValidateInvitation"
          parent="webscript">
        <property name="userService" ref="userService" /> 
        <property name="invitationService" ref="invitationService" /> 
        <property name="workflowService" ref="WorkflowService" /> 
        <property name="subSpaceAclService" ref="subSpaceAclService" /> 
        <property name="activityService" ref="activityService" />
        <property name="actionService" ref="ActionService" />
        <property name="siteService" ref="siteService" />
    </bean>


    <!--
    ==================================================================
    ========================== Shares ==============================
    ==================================================================
    -->
    
    <!-- share secured item -->
    <bean id="webscript.fr.itldev.koya.share.shareitems.post" 
          class="fr.itldev.koya.webscript.share.ShareItems"
          parent="webscript">                
        <property name="subSpaceConsumersAclService" ref="subSpaceConsumersAclService" />   
        <property name="koyaNodeService" ref="koyaNodeService" />   
        <property name="transactionService" ref="transactionService"/>
    </bean>
    
    <!-- items shared with users -->
    <bean id="webscript.fr.itldev.koya.share.sharedusers.get" 
          class="fr.itldev.koya.webscript.share.SharedUsers"
          parent="webscript">
        <property name="subSpaceAclService" ref="subSpaceAclService" />   
        <property name="koyaNodeService" ref="koyaNodeService" />   

    </bean>
    
    <bean id="webscript.fr.itldev.koya.share.listusershares.get" 
          class="fr.itldev.koya.webscript.share.ListUserShares"
          parent="webscript">
        <property name="subSpaceConsumersAclService" ref="subSpaceConsumersAclService" />   
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="userService" ref="userService"/>
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.share.consumer.get" 
          class="fr.itldev.koya.webscript.share.IsSharedConsumer"
          parent="webscript">
        <property name="subSpaceAclService" ref="subSpaceAclService" />   
        <property name="koyaNodeService" ref="koyaNodeService"/>
    </bean>
    
       
    <!--
    ==================================================================
    ========================== Meta  ==============================
    ==================================================================
    -->
    
    
    <!-- items shared with users -->
    <bean id="webscript.fr.itldev.koya.meta.infos.get" 
          class="fr.itldev.koya.webscript.meta.GetInfos"
          parent="webscript">
        <property name="moduleService" ref="moduleService" />   
    </bean>
    
    <bean id="webscript.fr.itldev.koya.meta.libversion.get" 
          class="fr.itldev.koya.webscript.meta.GetVersion"
          parent="webscript">
    </bean>
    
    
    <!-- Dump company all subspaces node permissions
    for debug 
    -->
    <bean id="webscript.fr.itldev.koya.meta.dumpPermissions.get" 
          class="fr.itldev.koya.webscript.meta.DumpPermissions"
          parent="webscript">
        <property name="debuggerService" ref="debuggerService" />   
        <property name="spaceService" ref="spaceService" />   
    </bean>
    <!--
    ==================================================================
    ========================== Notifications  ========================
    ==================================================================
    -->
    
    <bean id="webscript.fr.itldev.koya.user.emailnotification.get" 
          class="fr.itldev.koya.webscript.user.NotificationStatus"
          parent="webscript">
        <property name="koyaNotificationService" ref="koyaNotificationService" />
        <property name="userService" ref="userService"/>   
    </bean>
    
    
    <!--
    ==================================================================
    ========================== Reset Password Workflow ===============
    ==================================================================
    -->
    
    <bean id="webscript.fr.itldev.koya.resetpassword.request.post" 
          class="fr.itldev.koya.webscript.resetpassword.ResetRequest"
          parent="webscript">
        <property name="userService" ref="userService" />   
        <property name="workflowService" ref="WorkflowService" />   
    </bean>
    
    
    <bean id="webscript.fr.itldev.koya.resetpassword.validation.post" 
          class="fr.itldev.koya.webscript.resetpassword.ResetValidation"
          parent="webscript">       
        <property name="workflowService" ref="WorkflowService" />   
    </bean>

</beans>

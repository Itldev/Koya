<?xml version='1.0' encoding='UTF-8'?>
<!--

    Koya is an alfresco module that provides a corporate orientated dataroom.

    Copyright (C) Itl Developpement 2014

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see `<http://www.gnu.org/licenses/>`.

-->

<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>
<beans>
    
    
    <!--    For all Alfresco services, we defaultly use Upper case bean reference because
    if salfly calls service : http://alfrescoshare.wordpress.com/2010/01/06/alfresco-coding-best-practice-how-to-safely-call-java-services/
    -->
    
    <!--Global Koya nodes util services-->
    <bean name="koyaNodeService" class="fr.itldev.koya.alfservice.KoyaNodeService">
        <property name="nodeService" ref="NodeService"/>
        <property name="unsecuredNodeService" ref="nodeService"/>
        <property name="favouritesService" ref="favouritesService"/>
        <property name="preferenceService" ref="preferenceService"/>
        <property name="dictionaryService" ref="DictionaryService"/>
        <property name="companyService" ref="companyService"/>
        <property name="fileFolderService" ref="FileFolderService" />
        <property name="authenticationService" ref="AuthenticationService" />
        <property name="koyaShareService" ref="koyaShareService"/>
        <property name="koyaAclService" ref="koyaAclService"/>
    </bean>
    
    <!--Companies handling service-->
    <bean name="companyService" class="fr.itldev.koya.alfservice.CompanyService">
        <property name="siteService" ref="siteService"/>
        <property name="nodeService" ref="NodeService"/>
        <property name="unprotectedNodeService" ref="nodeService" />
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="modelService" ref="modelService" />
        <property name="authenticationService" ref="AuthenticationService" />
        <property name="fileFolderService" ref="FileFolderService" />
    </bean>     
    
    <!--Spaces Handling service-->
    <bean name="spaceService" class="fr.itldev.koya.alfservice.SpaceService">
        <property name="nodeService" ref="NodeService"/>
        <property name="searchService" ref="SearchService"/>
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="companyService" ref="companyService"/>
        <property name="koyaAclService" ref="koyaAclService"/>
        <property name="fileFolderService" ref="FileFolderService"/>
    </bean> 
    
    <!--Dossiers handling service-->
    <bean name="dossierService" class="fr.itldev.koya.alfservice.DossierService">
        <property name="nodeService" ref="NodeService"/>
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="fileFolderService" ref="FileFolderService"/>
    </bean>

    <!--Contents handling service-->
    <bean name="koyaContentService" class="fr.itldev.koya.alfservice.KoyaContentService">
        <property name="nodeService" ref="NodeService"/>
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="dictionaryService" ref="DictionaryService"/>
        <property name="contentService" ref="contentService"/>
        <property name="namespaceService" ref="NamespaceService"/>
        <property name="fileFolderService" ref="FileFolderService"/>
        <property name="koyaAclService" ref="koyaAclService"/>     
        <property name="actionService" ref="ActionService"/>
    </bean>
   
    
    
    <!--Sales Offer Handling service-->
    <bean name="salesOfferService" class="fr.itldev.koya.alfservice.SalesOfferService">
        <property name="nodeService" ref="NodeService"/>
        <property name="koyaNodeService" ref="koyaNodeService"/>
    </bean>
    
    <!--Users handling service-->
    <bean name="userService" class="fr.itldev.koya.alfservice.UserService">
        <property name="nodeService" ref="NodeService"/>
        <property name="personService" ref="PersonService"/>
        <property name="searchService" ref="SearchService"/>
        <property name="authenticationService" ref="AuthenticationService"/>
        <property name="siteService" ref="SiteService"/>
    </bean>
   
    <!--Data Import/Export Service-->
    <bean name="importExportService" class="fr.itldev.koya.alfservice.ImportExportService"/>
    <!--Model Handling service-->
    <bean name="modelService" class="fr.itldev.koya.alfservice.ModelService">
        <property name="nodeService" ref="NodeService"/>
        <property name="copyService" ref="CopyService"/>
        <property name="searchService" ref="SearchService"/>
        <property name="siteService" ref="SiteService"/>
    </bean>
    
    <!--Profiles Handling Service-->
    <bean name="profileService" class="fr.itldev.koya.alfservice.ProfileService"/>    
    <!--Question/Answer Handling service-->
    <bean name="qaService" class="fr.itldev.koya.alfservice.QaService"/>
    <!--Statistics Handling Service-->
    <bean name="statService" class="fr.itldev.koya.alfservice.StatService"/>
    
    <!--Alerts Handling Service-->
    <bean name="alertService" class="fr.itldev.koya.alfservice.AlertService"/>
    
    <!--Mailing Service-->
    <bean name="mailingService" class="fr.itldev.koya.alfservice.MailingService"/>
    
<!--    
    
    
    ACL Services
    
    
    -->
    <!--Koya specific Permissions service-->
    <bean name="koyaAclService" class="fr.itldev.koya.alfservice.KoyaAclService">     
        <property name="koyaNodeService" ref="koyaNodeService"/>
        <property name="permissionService" ref="PermissionService"/>     
        <property name="nodeService" ref="NodeService"/>       
        <property name="authenticationService" ref="AuthenticationService"/>      
    </bean>
    
    <!--Secured Items Sharing service-->
    <bean name="koyaShareService" class="fr.itldev.koya.alfservice.KoyaShareService" parent="koyaAclService">
        <property name="spaceService" ref="spaceService"/>  
        <property name="dossierService" ref="dossierService"/> 
        <property name="userService" ref="userService"/>
        <property name="siteService" ref="SiteService"/>            
        <property name="fileFolderService" ref="FileFolderService"/>     
        <property name="invitationService" ref="invitationService"/>
    </bean>
    
    <!--  Invitation Service Configuration File --> 
    <bean id="invitationService" class="org.alfresco.repo.invitation.InvitationKoyaServiceImpl" init-method="init">
        <property name="workflowService" ref="WorkflowService"/>
        <property name="workflowAdminService" ref="workflowAdminService"/>
        <property name="actionService" ref="ActionService"/>
        <property name="personService" ref="PersonService"/>
        <property name="permissionService" ref="PermissionService"/>
        <property name="authenticationService" ref="AuthenticationService"/>
        <property name="siteService" ref="SiteService"/>
        <property name="namespaceService" ref="NamespaceService"/>
        <property name="dictionaryService" ref="DictionaryService"/>
        <property name="nodeService" ref="NodeService"/>
        <property name="userNameGenerator" ref="userNameGenerator"/>
        <property name="passwordGenerator" ref="passwordGenerator"/> 
        <property name="sendEmails" value="${notification.email.siteinvite}"/> 
        <property name="policyComponent">
            <ref bean="policyComponent" />
        </property>
        <property name="sysAdminParams" ref="sysAdminParams"/>
    </bean>

    <bean id="nameBasedUserNameGenerator" class="fr.itldev.koya.repo.security.authentication.EmailBasedNameGenerator" />
    
</beans>
